<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * Copyright 2025 Adobe
 * All Rights Reserved.
 */
-->
<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/testSchema.xsd">
    <test name="StorefrontVerifyRegistrationFormValidationMessagesTest">
        <annotations>
            <features value="Customer"/>
            <stories value="Customer Registration Form Validation"/>
            <title value="Verify validation error messages display consistently on registration form across multiple submissions"/>
            <description value="Verify that all required fields on customer registration form display proper mage-error validation messages when form is submitted without filling any data"/>
            <severity value="MINOR"/>
            <testCaseId value="AC-15355"/>
            <group value="customer"/>
            <group value="customer_registration"/>
        </annotations>
        <after>
            <actionGroup ref="StorefrontCustomerLogoutActionGroup" stepKey="customerLogoutStorefront"/>
            <actionGroup ref="AdminLoginActionGroup" stepKey="LoginAdmin"/>
            <actionGroup ref="AdminDeleteCustomerActionGroup" stepKey="deleteCustomer">
                <argument name="customerEmail" value="Simple_US_Customer.email"/>
            </actionGroup>
            <actionGroup ref="AdminLogoutActionGroup" stepKey="logout"/>
        </after>
        <!-- Step 3: Navigate to customer registration page -->
        <actionGroup ref="StorefrontOpenCustomerAccountCreatePageActionGroup" stepKey="openCreateAccountPage"/>
        <!-- Step 4: Submit form without filling any data (Iteration 1) -->
        <scrollTo selector="{{StorefrontCustomerCreateFormSection.createAccountButton}}" stepKey="scrollToCreateButton"/>
        <waitForElementClickable selector="{{StorefrontCustomerCreateFormSection.createAccountButton}}" stepKey="waitForCreateAccountButton"/>
        <click selector="{{StorefrontCustomerCreateFormSection.createAccountButton}}" stepKey="clickCreateAccountButton"/>
        <waitForPageLoad stepKey="waitForValidation"/>
        <!-- Verify all required fields display proper error messages -->
        <actionGroup ref="StorefrontAssertCustomerRegistrationValidationMessagesActionGroup" stepKey="assertValidationMessagesIteration1"/>
        <!-- Step 5: Refresh the browser page -->
        <reloadPage stepKey="refreshPage"/>
        <waitForPageLoad stepKey="waitForPageLoad"/>
        <!-- Step 6: Submit form without filling any data (Iteration 2) -->
        <scrollTo selector="{{StorefrontCustomerCreateFormSection.createAccountButton}}" stepKey="scrollToCreateButtonAfterRefresh"/>
        <waitForElementClickable selector="{{StorefrontCustomerCreateFormSection.createAccountButton}}" stepKey="waitForCreateAccountButtonAfterRefresh"/>
        <click selector="{{StorefrontCustomerCreateFormSection.createAccountButton}}" stepKey="clickCreateAccountButtonAfterRefresh"/>
        <waitForPageLoad stepKey="waitForValidationAfterRefresh"/>
        <!-- Verify all validation messages - Iteration 2 -->
        <actionGroup ref="StorefrontAssertCustomerRegistrationValidationMessagesActionGroup" stepKey="assertValidationMessagesIteration2"/>
        <!-- Step 7: Repeat steps 5 & 6 (Iteration 3) -->
        <reloadPage stepKey="refreshPageThirdTime"/>
        <waitForPageLoad stepKey="waitForPageLoadThirdTime"/>
        <scrollTo selector="{{StorefrontCustomerCreateFormSection.createAccountButton}}" stepKey="scrollToCreateButtonThirdTime"/>
        <waitForElementClickable selector="{{StorefrontCustomerCreateFormSection.createAccountButton}}" stepKey="waitForCreateAccountButtonThirdTime"/>
        <click selector="{{StorefrontCustomerCreateFormSection.createAccountButton}}" stepKey="clickCreateAccountButtonThirdTime"/>
        <waitForPageLoad stepKey="waitForValidationThirdTime"/>
        <!-- Verify all validation messages - Iteration 3 -->
        <actionGroup ref="StorefrontAssertCustomerRegistrationValidationMessagesActionGroup" stepKey="assertValidationMessagesIteration3"/>
        <!-- Step 8: Fill form with valid data and complete registration -->
        <actionGroup ref="StorefrontFillCustomerAccountCreationFormActionGroup" stepKey="fillCreateAccountForm">
            <argument name="customer" value="Simple_US_Customer"/>
        </actionGroup>
        <!-- Step 9: Click on save button -->
        <actionGroup ref="StorefrontClickCreateAnAccountCustomerAccountCreationFormActionGroup" stepKey="submitCreateAccountForm"/>
        <!-- Verify success message is displayed -->
        <actionGroup ref="AssertMessageCustomerCreateAccountActionGroup" stepKey="seeSuccessMessage">
            <argument name="messageType" value="success"/>
            <argument name="message" value="{{customerSavedSuccessfullyMessage.value}}"/>
        </actionGroup>
    </test>
</tests>
